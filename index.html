<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Professional Website</title>

    <link rel="stylesheet" href="style.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/23.0.10/css/intlTelInput.css" integrity="sha512-qc5ao9G+o/Nn7o+7uM+13N08g+lFbO+2/Zt+wCLl3/122u7IqIS7+7c55eN1f0LwAgF1LhIDfYvL5X3+FpV/xw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
      /* Add some basic styles for the library if needed */
      .iti { width: 100%; } /* Make the phone input container full width */
    </style>

</head>
<body>

    <h1>Contact Us</h1>
    <p>Please fill out the form below to get in touch.</p>

    <form id="contact-form" action="https://formspree.io/f/xldbrazl" method="POST">
        <div class="form-group">
            <label for="first_name">First Name:</label>
            <input type="text" id="first_name" name="first_name" required>
        </div>

        <div class="form-group">
            <label for="surname">Surname:</label>
            <input type="text" id="surname" name="surname" required>
        </div>

        <div class="form-group">
            <label for="email">Your Email:</label>
            <input type="email" id="email" name="_replyto" required> </div>

        <div class="form-group">
            <label for="phone">Phone Number:</label>
            <input type="tel" id="phone" name="phone" required>
        </div>

        <div class="form-group">
            <label for="address_street">Street Address:</label>
            <input type="text" id="address_street" name="address_street">
        </div>

        <div class="form-group">
            <label for="address_city">City:</label>
            <input type="text" id="address_city" name="address_city">
        </div>

        <div class="form-group">
            <label for="address_postal_code">Postal Code:</label>
            <input type="text" id="address_postal_code" name="address_postal_code">
        </div>

        <div class="form-group">
            <label for="address_country">Country:</label>
            <input type="text" id="address_country" name="address_country">
            </div>


        <div class="form-group">
            <label for="inquiry_type">Reason for Contact:</label>
            <select id="inquiry_type" name="inquiry_type" required>
                <option value="">--Please choose an option--</option>
                <option value="general">General Inquiry</option>
                <option value="support">Support Request</option>
                <option value="quote">Request a Quote</option>
                <option value="feedback">Feedback</option>
                <option value="callback_request">Callback Request</option> </select>
        </div>

        <div class="form-group">
             <fieldset>
                <legend>Options:</legend>
                <label>
                    <input type="checkbox" name="request_callback" value="yes"> Please call me back regarding this inquiry.
                </label>
                </fieldset>
        </div>

        <button type="submit">Submit Information</button>
        <p id="form-status"></p> </form>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/23.0.10/js/intlTelInput.min.js" integrity="sha512-0PksPNPkv+sP29l44+EKq797gG0oMLyzClx8eFqF/XyqB/nU4Gz4U/T+W6fU/c8l8/Q+3nBTmF91f72QSmwHqg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
      // Initialize intl-tel-input
      const phoneInputField = document.querySelector("#phone");
      const phoneInput = window.intlTelInput(phoneInputField, {
          utilsScript: "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/23.0.10/js/utils.js", // for validation & formatting
          initialCountry: "auto", // Automatically detect user's country
          geoIpLookup: callback => {
              fetch("https://ipapi.co/json") // Simple free IP lookup
                  .then(res => res.json())
                  .then(data => callback(data.country_code))
                  .catch(() => callback("us")); // Fallback to US
          },
          separateDialCode: true, // Show dial code separately
          // preferredCountries: ["ge", "us", "gb"], // Optional: Prioritize certain countries
      });

      // Your existing form submission handling script
      var form = document.getElementById("contact-form");
      var status = document.getElementById("form-status");

      async function handleSubmit(event) {
          event.preventDefault();

          // Optional: Get the full number with country code from intl-tel-input
          const fullNumber = phoneInput.getNumber();
          // You might want to put this full number into a hidden input field
          // before submitting, or handle it differently depending on your needs.
          // For now, the original input 'phone' will contain the number without the code
          // unless you modify this part. Let's add a hidden field for the full number:

          let hiddenInput = form.querySelector('input[name="full_phone_number"]');
          if (!hiddenInput) {
              hiddenInput = document.createElement('input');
              hiddenInput.type = 'hidden';
              hiddenInput.name = 'full_phone_number';
              form.appendChild(hiddenInput);
          }
          hiddenInput.value = fullNumber;


          var data = new FormData(event.target);
          status.innerHTML = 'Sending...';
          status.className = '';
          fetch(event.target.action, {
              method: form.method,
              body: data,
              headers: { 'Accept': 'application/json' }
          }).then(response => {
              if (response.ok) {
                  status.innerHTML = "Thanks for your submission!";
                  status.className = 'success';
                  form.reset();
                  // Reset intl-tel-input to default country after submission
                  phoneInput.setCountry("us"); // Or reset based on IP lookup again if needed
              } else {
                  response.json().then(data => {
                      if (Object.hasOwn(data, 'errors')) {
                          status.innerHTML = data["errors"].map(error => error["message"]).join(", ");
                      } else {
                          status.innerHTML = "Oops! There was a problem submitting your form";
                      }
                      status.className = 'error';
                  }).catch(() => { // Catch potential JSON parsing errors too
                       status.innerHTML = "Oops! There was a problem submitting your form (invalid response).";
                       status.className = 'error';
                  });
              }
          }).catch(error => {
              status.innerHTML = "Oops! Network error or problem submitting your form";
              status.className = 'error';
          });
      }
      form.addEventListener("submit", handleSubmit);
    </script>

</body>
</html>